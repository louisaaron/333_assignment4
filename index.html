<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Registrar's Office Class Search</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
  </head>

  <body>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
    
    <div class="text-center text-white container-fluid pb-4" style="background-color: #295078;">
      <div class="row">
        <h1>Registrar's Office: Class Search</h1>
      </div>
      <div class="row">
        <div class="col-sm"><input type="text" class="form-control" placeholder="Department" aria-label="Department" id="authorInput"></div>
        <div class="col-sm"><input type="text" class="form-control" placeholder="Number" aria-label="Number" id="authorInput"></div>
        <div class="col-sm"><input type="text" class="form-control" placeholder="Area" aria-label="Area" id="authorInput"></div>
        <div class="col-sm"><input type="text" class="form-control" placeholder="Title" aria-label="Title" id="authorInput"></div>
      </div>
    </div>

    <div class="container-fluid m-0">
      <table class="table table-striped table-fit">
        <tbody>
          <tr></tr>
          <tr>
            <th scope="col">ClassId</th>
            <th scope="col">Dept</th>
            <th scope="col">Num</th>
            <th scope="col">Area</th>
            <th scope="col">Title</th>
          </tr>
          <tr>
            <td>1</th>
            <td>Mark</td>
            <td>Otto</td>
            <td>@mdo</td>
            <td>Test text goes here, want to see what happens if it's really long. Test text goes here, want to see what happens if it's really long. Test text goes here, want to see what happens if it's really long. Test text goes here, want to see what happens if it's really long.</td>
          </tr>
          <tr>
            <td>2</th>
            <td>Jacob</td>
            <td>Thornton</td>
            <td>@fat</td>
            <td>@mdo</td>
          </tr>
          <tr>
            <td>3</th>
            <td>Larry</td>
            <td>the Bird</td>
            <td>@twitter</td>
            <td>@mdo</td>
          </tr>
        </tbody>
      </table>
    </div>

    <div class="text-center text-white container-fluid" style="background-color: #295078;">
      <p>Created by <a href="www.google.com">Louis Aaron</a> and <a href="www.google.com">Max Chan</a></p>
    </div>
    

    <script>

      'use strict';

      function getAmPm()
      {
        let dateTime =  new Date();
        let hours = dateTime.getHours();
        let amPm = 'morning';

        if (hours >= 12)
          amPm = 'afternoon';

        let ampmSpan = document.getElementById('ampmSpan');
        ampmSpan.innerHTML = amPm;
      }

      function getDateTime()
      {
        let dateTime = new Date();
        let daetimeSpan =  document.getElementById('datetimeSpan');
        datetimeSpan.innerHtml = dateTime.toLocaleString();
      }

      function usingResponseGetText(resp)
      {
        return resp.text();
      }

      function usingTextUpdateResultsParagraph(text)
      {
        let resultsParagraph =
          document.getElementById('resultsParagraph');
        resultsParagraph.innerHTML =  text;
      }

      let controller = null;

      function getResults()
      {
        let authorInput = document.getElementById('authorInput');
        let author = authorInput.value;
        let encodedAuthor = encodedURIComponent(author);
        let url = '/searchresults?author=' + encodedAuthor;

        if (controller !== null)
          controller.abort();
        controller = new AbortController();

        fetch(url, {signal: controller.signal})
          .then(usingResponseGetText)
          .then(usingTextUpdateResultsParagraph)
          .catch(function(err) {console.log(err);});

      }

      function setup()
      {
        getAmPm();
        window.setInterval(getAmPm, 1000);
        getDateTime();
        window.setInerval(getDateTime, 1000);
        let authorInput = document.getElementById('authorInput');
        authorInput.addEventListener('input', getResults);
      }

      document.addEventListener(('DOMContentLoaded'), setup);

    </script>
  </body>
</html>
